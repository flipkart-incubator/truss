!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Truss=t():e.Truss=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PubSub=t.Truss=void 0;var i=n(1),o=r(i),s=n(2),u=r(s);t.Truss=o.default,t.PubSub=u.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){function t(){return c++,"UIF-"+c}function n(e,n,r,o,s){var u,c,a,f=i[n],d=o.instanceConfig.listensTo;return c=new r({parentInstanceId:s,moduleName:n,instanceConfig:o.instanceConfig,uniqueId:t(),parentCssSelector:s?l[s].moduleInstance.getCssSelector():void 0}),u=e.extend(c,f.properties),a=u.getUniqueId(),s&&l[s].modules.push(a),l[a]={moduleInstance:u,parentInstanceId:s,modules:[]},u.createPlayArena(),u.setup(),d&&d.forEach(function(e){u.subscribe({eventName:e.eventName,callback:u[e.callback],context:u,eventPublisher:e.eventPublisher,once:e.once})}),u}function r(e){return new o.Promise(function(t,n){n(e)})}var i={},s={},c=-1,l={};return{plugins:{},register:function(e,t){i[e]||(i[e]={properties:t})},createInstance:function(e,t,s){var u,c,f,d=e.moduleName,h=i[d],p=this;return u=new o.Promise(function(e,u){if(h&&h.properties){if(s&&!l[s])return r("CONFIG_FETCHED");c=n(p,d,a.default,{instanceConfig:t},s),f=c.getUniqueId();var v=new o.Promise(function(e){var n;t.initOn?(n=t.initOn,c.subscribe({eventName:n.eventName,callback:function(t){e(t)},context:c,eventPublisher:n.eventPublisher,once:!0}),c.publish(c.getModuleName()+"_CREATED",{moduleInstanceId:f})):(c.publish(c.getModuleName()+"_CREATED",{moduleInstanceId:f}),e())});v.then(function(e){function t(){c.publish(c.getModuleName()+"_READY",{moduleInstanceId:f})}return s&&!l[s]?r("SUBSCRIBED"):c.init(e).then(function(){return t(),!0},function(){return t(),!0})}).then(function(){return new o.Promise(function(e,t){h.properties.config&&"function"==typeof h.properties.config.then?h.properties.config.then(function(t){i[d].config=t,e(t)},function(e){t(e)}):h.properties.config?(i[d].config=h.properties.config,e(h.properties.config)):(i[d].config={},e({}))})}).then(function(n){if(n.modules){p.loadModule(n.modules);var r=[];n.modules.forEach(function(e){var n=t&&t.modules&&t.modules.filter(function(t){return t.moduleName===e.moduleName&&t.instanceConfig.container===e.instanceConfig.container})[0],i=e.instanceConfig;n&&n.instanceConfig&&(i.placeholders=n.instanceConfig.placeholders||t.placeholders,i.listensTo=n.instanceConfig.listensTo||t.listensTo,i.autorender=n.instanceConfig.autorender===!1?!1:t.autorender);var o=p.createInstance(e,i,f);r.push(o)}),o.Promise.all(r).then(function(){s&&!l[s]&&(p.destroyModuleInstance(f),u("Module instantiation for "+d+" failed because parent with id "+s+" is already distroyed.")),e(f)},function(){s&&!l[s]&&(p.destroyModuleInstance(f),u("Module instantiation for "+d+" failed because parent with id "+s+" is already distroyed.")),e(f)})}else s&&!l[s]&&(p.destroyModuleInstance(f),u("Module instantiation for "+d+" failed because parent with id "+s+" is already distroyed.")),e(f)},function(e){switch(e){case"SUBSCRIBED":p.destroyModuleInstance(f)}}).catch(function(e){})}})},destroyModuleInstance:function(e){var t,n,r=l[e],i=r.parentInstanceId,o=i?l[i]:void 0,s=this;r&&(t=r.moduleInstance,r.modules&&r.modules.forEach(function(e){s.destroyModuleInstance(e)}),n=t.getAllSubscriptions(),n.forEach(function(e){t.unsubscribe(e.eventName,e.callback)}),t.destroy(),t.destroyPlayArena(i),t.isDestroyed=!0,o&&(o.modules=o.modules.filter(function(t){return t!==e})),delete l[e])},loadModule:function(e){var t,n=this;t=Array.isArray(e)?e:[e],t.forEach(function(e){var t=e.moduleName;i[t]||(e.instance?n.register(t,e.instance):logit.error("No module with name "+t))})},loadApp:function(e){this.publish("CORE","APP_LOADED",e)},subscribe:function(e){var t=e.eventName;s[t]||(s[t]=[]),s[t].push(u.default.pick(e,["callback","eventSubscriber","context","eventPublisher","once"]))},publish:function(e,t,n){var r=s[t],i=[];r&&r.length&&r.forEach(function(t){var r=t.callback,o=t.context,s=t.once;if(t.eventPublisher){var u=RegExp(t.eventPublisher+"$");if(u.test(e))r.apply(o?o:null,[n]),s||i.push(t);else{for(var c=e.split(" "),a=t.eventPublisher.split(" "),l=c.length,f=a.length;c.length&&a.length;)l=c.length,f=a.length,c[l-1]===a[f-1]?(c.pop(),a.pop()):c.pop();a.length?i.push(t):(r.apply(o?o:null,[n]),s||i.push(t))}}else r.apply(o?o:null,[n]),s||i.push(t)}),s[t]=i},unsubscribe:function(e,t,n){var r=s[t];s[t]=r.filter(function(t){return!(t.callback===n&&t.eventSubscriber===e)})},logAllModuleInstances:function(){},extend:function(e,t){function n(){}return n.prototype=e,Object.assign(new n,t)}}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),s=n(3),u=r(s),c=n(4),a=r(c);t.default=new i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i);t.default={publish:function(e,t,n){o.default.publish(e,t,n)},subscribe:function(e){o.default.subscribe(e)},unsubscribe:function(e,t,n){o.default.unsubscribe(e,t,n)}}},function(e,t){"use strict"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=[];e=Object.assign({},e),this.isDestroyed=!1,this.modulePlaceholders=e.instanceConfig.placeholders,this.getUniqueId=function(){return e.uniqueId},this.getParentInstanceId=function(){return e.parentInstanceId},this.getModuleName=function(){return e.moduleName},this.getInstanceConfig=function(){return e.instanceConfig},this.subscribe=function(e){e.eventSubscriber=this.getModuleContainer(),t.push(e),s.default.subscribe(e)},this.unsubscribe=function(e,n){t=t.filter(function(t){return t.callback!==n||t.eventName!==e}),s.default.unsubscribe(this.getModuleContainer(),e,n)},this.getAllSubscriptions=function(){return t},this.getArenaContainer=function(){return e.instanceConfig.container},this.getCssSelector=function(){return e.parentCssSelector?e.parentCssSelector+" "+this.getArenaContainer():this.getArenaContainer()}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=r(o);i.prototype={init:function(){return this.render()},setup:function(){},destroy:function(){var e=document.querySelector(this.getModuleContainer());e.innerHTML=""},createPlayArena:function(){var e=this.getParentInstanceId()?"#"+this.getParentInstanceId()+" "+this.getArenaContainer():this.getArenaContainer(),t=this.getInstanceConfig().theme?this.getModuleName()+"-"+this.getInstanceConfig().theme:this.getModuleName()+"-default";document.querySelector(e).innerHTML='<div id="'+this.getUniqueId()+'" class="'+t+' play-arena"></div>'},destroyPlayArena:function(){var e=this.getParentInstanceId()?"#"+this.getParentInstanceId()+" "+this.getArenaContainer()+" #"+this.getUniqueId():this.getArenaContainer()+" #"+this.getUniqueId(),t=document.querySelector(e);t.parentNode.removeChild(t)},getModuleContainer:function(){return"#"+this.getUniqueId()},publish:function(e,t){!this.isDestroyed&&s.default.publish(this.getCssSelector(),e,t)},hasModuleConfig:!0},t.default=i},function(e,t,n){var r;(function(e,i,o){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
	 * @version   3.1.2
	 */
(function(){"use strict";function s(e){return"function"==typeof e||"object"==typeof e&&null!==e}function u(e){return"function"==typeof e}function c(e){$=e}function a(e){V=e}function l(){return function(){e.nextTick(v)}}function f(){return function(){W(v)}}function d(){var e=0,t=new ee(v),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function h(){var e=new MessageChannel;return e.port1.onmessage=v,function(){e.port2.postMessage(0)}}function p(){return function(){setTimeout(v,1)}}function v(){for(var e=0;Q>e;e+=2){var t=re[e],n=re[e+1];t(n),re[e]=void 0,re[e+1]=void 0}Q=0}function g(){try{var e=n(9);return W=e.runOnLoop||e.runOnContext,f()}catch(t){return p()}}function b(e,t){var n=this,r=n._state;if(r===ue&&!e||r===ce&&!t)return this;var i=new this.constructor(y),o=n._result;if(r){var s=arguments[r-1];V(function(){q(r,i,s,o)})}else N(n,i,e,t);return i}function m(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(y);return E(n,e),n}function y(){}function _(){return new TypeError("You cannot resolve a promise with itself")}function w(){return new TypeError("A promises callback cannot return that same promise.")}function I(e){try{return e.then}catch(t){return ae.error=t,ae}}function C(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function A(e,t,n){V(function(e){var r=!1,i=C(n,t,function(n){r||(r=!0,t!==n?E(e,n):x(e,n))},function(t){r||(r=!0,T(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,T(e,i))},e)}function P(e,t){t._state===ue?x(e,t._result):t._state===ce?T(e,t._result):N(t,void 0,function(t){E(e,t)},function(t){T(e,t)})}function M(e,t,n){t.constructor===e.constructor&&n===ie&&constructor.resolve===oe?P(e,t):n===ae?T(e,ae.error):void 0===n?x(e,t):u(n)?A(e,t,n):x(e,t)}function E(e,t){e===t?T(e,_()):s(t)?M(e,t,I(t)):x(e,t)}function S(e){e._onerror&&e._onerror(e._result),j(e)}function x(e,t){e._state===se&&(e._result=t,e._state=ue,0!==e._subscribers.length&&V(j,e))}function T(e,t){e._state===se&&(e._state=ce,e._result=t,V(S,e))}function N(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+ue]=n,i[o+ce]=r,0===o&&e._state&&V(j,e)}function j(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r,i,o=e._result,s=0;t.length>s;s+=3)r=t[s],i=t[s+n],r?q(n,r,i,o):i(o);e._subscribers.length=0}}function O(){this.error=null}function k(e,t){try{return e(t)}catch(n){return le.error=n,le}}function q(e,t,n,r){var i,o,s,c,a=u(n);if(a){if(i=k(n,r),i===le?(c=!0,o=i.error,i=null):s=!0,t===i)return void T(t,w())}else i=r,s=!0;t._state!==se||(a&&s?E(t,i):c?T(t,o):e===ue?x(t,i):e===ce&&T(t,i))}function D(e,t){try{t(function(t){E(e,t)},function(t){T(e,t)})}catch(n){T(e,n)}}function U(e){return new ge(this,e).promise}function L(e){function t(e){E(i,e)}function n(e){T(i,e)}var r=this,i=new r(y);if(!J(e))return T(i,new TypeError("You must pass an array to race.")),i;for(var o=e.length,s=0;i._state===se&&o>s;s++)N(r.resolve(e[s]),void 0,t,n);return i}function R(e){var t=this,n=new t(y);return T(n,e),n}function F(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function B(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Y(e){this._id=pe++,this._state=void 0,this._result=void 0,this._subscribers=[],y!==e&&("function"!=typeof e&&F(),this instanceof Y?D(this,e):B())}function H(e,t){this._instanceConstructor=e,this.promise=new e(y),Array.isArray(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=Array(this.length),0===this.length?x(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&x(this.promise,this._result))):T(this.promise,this._validationError())}function G(){var e;if(void 0!==i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;n&&"[object Promise]"===Object.prototype.toString.call(n.resolve())&&!n.cast||(e.Promise=ve)}var K;K=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var W,$,z,J=K,Q=0,V=function(e,t){re[Q]=e,re[Q+1]=t,Q+=2,2===Q&&($?$(v):z())},X="undefined"!=typeof window?window:void 0,Z=X||{},ee=Z.MutationObserver||Z.WebKitMutationObserver,te=void 0!==e&&"[object process]"==={}.toString.call(e),ne="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,re=Array(1e3);z=te?l():ee?d():ne?h():void 0===X?g():p();var ie=b,oe=m,se=void 0,ue=1,ce=2,ae=new O,le=new O,fe=U,de=L,he=R,pe=0,ve=Y;Y.all=fe,Y.race=de,Y.resolve=oe,Y.reject=he,Y._setScheduler=c,Y._setAsap=a,Y._asap=V,Y.prototype={constructor:Y,then:ie,"catch":function(e){return this.then(null,e)}};var ge=H;H.prototype._validationError=function(){return Error("Array Methods must be provided an Array")},H.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===se&&e>n;n++)this._eachEntry(t[n],n)},H.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===oe){var i=I(e);if(i===ie&&e._state!==se)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===ve){var o=new n(y);M(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){t(e)}),t)}else this._willSettleAt(r(e),t)},H.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===se&&(this._remaining--,e===ce?T(r,n):this._result[t]=n),0===this._remaining&&x(r,this._result)},H.prototype._willSettleAt=function(e,t){var n=this;N(e,void 0,function(e){n._settledAt(ue,t,e)},function(e){n._settledAt(ce,t,e)})};var be=G,me={Promise:ve,polyfill:be};n(7).amd?(r=function(){return me}.call(t,n,t,o),!(void 0!==r&&(o.exports=r))):void 0!==o&&o.exports?o.exports=me:void 0!==this&&(this.ES6Promise=me),be()}).call(this)}).call(t,n(6),function(){return this}(),n(8)(e))},function(e,t){function n(){a=!1,s.length?c=s.concat(c):l=-1,c.length&&r()}function r(){if(!a){var e=setTimeout(n);a=!0;for(var t=c.length;t;){for(s=c,c=[];++l<t;)s&&s[l].run();l=-1,t=c.length}s=null,a=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function o(){}var s,u=e.exports={},c=[],a=!1,l=-1;u.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;arguments.length>n;n++)t[n-1]=arguments[n];c.push(new i(e,t)),1!==c.length||a||setTimeout(r,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=o,u.addListener=o,u.once=o,u.off=o,u.removeListener=o,u.removeAllListeners=o,u.emit=o,u.binding=function(e){throw Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t){e.exports=function(){throw Error("define cannot be used indirect")}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){}])});